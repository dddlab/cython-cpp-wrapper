## Test: coordinate-wise descent algorithm
x <- matrix(c(
  -0.57299987, -1.22881728,  0.24802264,  0.59779037,  0.65240208, 0.89373708,
  0.84087632, -0.3383771 ,  0.0794175 ,  0.12716686, -0.97403288,-0.30804861,
  0.13180135, -0.35350249,  0.01601294,  0.30258641,  0.19927309, 0.95847883,
  0.44658609,  0.12839939, -2.36179304, -3.2224078 , -0.92297796,-1.55831917,
  -1.00001779, -0.08302829,  0.6814525 ,  0.31812938, -0.50994963,-0.39614266,
  -0.3653738 , -0.20899641,  0.33488842,  0.93276311,  0.18263188,-1.58771894,
  0.53065032, -0.61604128, -0.67789621,  0.48183976,  0.20767173, 0.20307444,
  -0.13368724, -0.12181896, -0.52881865, -0.91883273, -0.35672818,-0.09414685,
  -1.23926047, -0.02615426, -1.02995135, -0.99250009, -0.89672846,-0.54350656,
  -0.97725987, -0.95743644, -0.47911092, -0.22157924,  1.8751929 , 1.04114063,
  1.4149165 ,  0.93326499, -0.09200369,  0.03342898,  1.71023076, 1.82671778,
  0.19710653, -0.94066402, -1.15043928,  0.88932662,  0.3247554 ,-0.87942537
), nrow = 12, ncol = 6, byrow = TRUE)
S = cov(x)
#print(gconcord(S = S, lambda1 = 0.2, lambda2 = 0.05, method = "ista"))
omega.s = gconcord(S = S, lambda1 = 0.2, lambda2 = 0.05, method = "coordinatewise")
omega.x = gconcord(data = x, lambda1 = 0.2, lambda2 = 0.05, method = "coordinatewise")
res <- matrix(c( 1.5218077, -0.4287111,  0.0000000,  0.0000000,  0.0000000,  0.0000000,
                -0.4287111,  3.0763360,  0.0000000,  0.2834247,  0.0000000,  0.0000000,
                 0.0000000,  0.0000000,  1.7742533, -0.6702583,  0.0000000, -0.1005374,
                 0.0000000,  0.2834247, -0.6702583,  0.9567856, -0.0945463,  0.0000000,
                 0.0000000,  0.0000000,  0.0000000, -0.0945463,  1.2949671, -0.5363858,
                 0.0000000,  0.0000000, -0.1005374,  0.0000000, -0.5363858,  1.0265813),
              nrow = 6, ncol = 6, byrow = TRUE)
expect_equal(sum(abs(omega.s-res)), 3.4e-07)  ## if estimated matrix is the same
expect_equal(sum(abs(omega.x-res)), 3.4e-07)  ## if estimated matrix is the same

## Test: coordinate-wise descent cross validation
set.seed(1)
cv = cv.gconcord(data = x, method = "coordinatewise")
expect_equal(sum(abs(c(cv$lam1.optimal, cv$lam2.optimal) - c(0.4380915, 0.2602936))), 1e-08) ## if optimal parameters are the same
